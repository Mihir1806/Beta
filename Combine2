# Perform the conditional join
    merged_rows = []
    
    for _, row1 in df1.iterrows():
        matching_rows = df2[(df2[lower_col] <= row1[col1]) & (df2[upper_col] >= row1[col1])]
        
        for _, row2 in matching_rows.iterrows():
            merged_rows.append({**row1.to_dict(), **row2.to_dict()})
    
    # Convert to DataFrame
    merged_df = pd.DataFrame(merged_rows)
    
    # Save the result to a new Excel file
    merged_df.to_excel(output_file, index=False)
    print(f"Merged file saved as {output_file}")

# Example usage
combine_excels('file1.xlsx', 'Sheet1', 'ColumnA', 'file2.xlsx', 'Sheet1', 'LowerBound', 'UpperBound', 'merged_output.xlsx')
