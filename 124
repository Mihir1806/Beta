let
    jobName = [Job Name],
    errorText = [Error],

    toolIdPart = 
        if errorText <> null and Text.Contains(errorText, "ToolId") then
            let
                afterToolId = Text.AfterDelimiter(errorText, "ToolId "),
                idText = Text.BeforeDelimiter(afterToolId, ":"),
                toolIdNumber = try Number.FromText(Text.Trim(idText)) otherwise null
            in
                toolIdNumber
        else
            null,

    toolName = 
        if toolIdPart <> null then
            let
                match = Table.SelectRows(ToolList, each [Job Name] = jobName and [Tool ID] = toolIdPart)
            in
                if Table.RowCount(match) > 0 then match{0}[Tool Name] else null
        else
            null,

    finalError = 
        if toolIdPart <> null and toolName <> null then
            Text.Replace(errorText, "ToolId " & Text.From(toolIdPart), "ToolId " & Text.From(toolIdPart) & " (Tool Name- " & toolName & ")")
        else
            errorText
in
    finalError