“I have the following Python code. It works partially but not perfectly — around 60–70% of the calculations and loop logic give correct results, but sometimes it fails. Please carefully analyze the entire code and then rewrite it in a clean, efficient, and fully working way.

Make sure to:
	1.	Improve the loop structures and remove redundancy.
	2.	Fix all calculation and comparison logic errors.
	3.	Ensure it handles edge cases.
	4.	Optimize for readability and performance.
	5.	Provide the corrected full working code