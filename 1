let
    errorText = [Error],  // Original error text
    jobName = [Job Name],  // Job name to filter ToolList

    // Step 1: Extract ToolIds from errorText
    toolIds = List.Transform(
                List.Select(
                    Text.SplitAny(errorText, " ,;:."),
                    each Text.StartsWith(Text.Trim(_), "ToolId")),
                each Text.Trim(Text.AfterDelimiter(_, "ToolId "))
              ),

    // Step 2: Lookup Tool Names for each ToolId
    toolListFiltered = Table.SelectRows(ToolList, each Text.Trim([Job Name]) = Text.Trim(jobName)),
    toolIdToNameList = List.Transform(toolListFiltered[Tool ID], each 
        [ToolId = Text.Trim([Tool ID]), ToolName = Text.Trim([Tool Name])]
    ),

    // Step 3: Replace ToolIds with Tool Names in errorText
    updatedError = List.Accumulate(
                    toolIds, 
                    errorText, 
                    (state, current) => Text.Replace(state, "ToolId " & current, "ToolId " & current & " (" & 
                    (List.First(List.Select(toolIdToNameList, each Text.Trim(Text.AfterDelimiter(_[ToolId], "ToolId ")) = current), null))[ToolName] & ")")
                  )
in
    updatedError