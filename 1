let
    // Reference the Job Name column
    JobName = [Job Name],

    // Split the Error1 column by semicolon to get individual ToolIds
    extractedToolIds = Text.Split([Error1], ";"),

    // Remove any extra spaces and trim ToolIds
    trimmedToolIds = List.Transform(extractedToolIds, each Text.Trim(_)),

    // Combine Job Name with each ToolId (e.g., "xyz-210")
    combined = List.Transform(trimmedToolIds, each JobName & "-" & _),

    // Join the combined values with "; "
    result = Text.Combine(combined, "; ")
in
    result





let
    parts = Text.Split([Error1], "ToolId "),
    extracted = List.Transform(
        List.Skip(parts, 1),
        each Text.BeforeDelimiter(Text.TrimStart(_), ":")
    ),
    distinctValues = List.Distinct(extracted),
    combined = List.Transform(distinctValues, each [Job Name] & "-" & _)
in
    Text.Combine(combined, "; ")






let
    parts = Text.Split([Error1], "ToolId "),
    extracted = List.Transform(
        List.Skip(parts, 1),
        each Text.BeforeDelimiter(Text.TrimStart(_), ":")
    )
in
    Text.Combine(extracted, "; ")




let
    parts = Text.Split([Error1], "ToolId "),
    extracted = List.Transform(
        List.Skip(parts, 1),
        each Text.BeforeDelimiter(Text.TrimStart(_), ":")
    ),
    distinctValues = List.Distinct(extracted)
in
    Text.Combine(distinctValues, "; ")






let
    Source = YourSourceTable,
    // Extract first ToolId
    AddedFirstToolId = Table.AddColumn(Source, "FirstToolId", each 
        let matches = Text.Matches([Error1], "ToolId\s*(\d+)")
        in if List.Count(matches) > 0 then matches{0}[Value] else null),
    // Extract all ToolIds as comma-separated string
    AddedAllToolIds = Table.AddColumn(AddedFirstToolId, "AllToolIds", each 
        Text.Combine(ExtractToolIds([Error1]), ", "))
in
    AddedAllToolIds









let
    // Split the Error1 column by "ToolId"
    SplitText = Text.Split([Error1], "ToolId"),
    // Skip the first part of the split since it won't contain any numbers
    ExtractNumbers = List.Transform(List.Skip(SplitText, 1), 
        each Text.Start(Text.AfterDelimiter(_, ":"), Text.PositionOf(Text.AfterDelimiter(_, ":"), " "))),
    // Combine all the extracted numbers, separated by commas
    Result = Text.Combine(ExtractNumbers, ", ")
in
    Result










let
    SplitText = Text.Split([LOG_STATUS], "ToolId"),
    ExtractNumbers = List.Transform(List.Skip(SplitText, 1), each Text.Start(_, Text.PositionOf(_, ":"))),
    Result = Text.Combine(ExtractNumbers, ", ")
in
    Result












let
    // Load your table (replace with your actual table name)
    Source = YourTableName,  // Replace YourTableName with your actual table name

    // Transform the Error column to replace line breaks (LF and CR) with semicolons
    CleanedErrorColumn = Table.TransformColumns(Source, {"Error", each Text.Replace(Text.Replace(_, "#(lf)", "; "), "#(cr)", "; "), type text})

in
    CleanedErrorColumn






Text.Replace(Text.Replace([Error], "#(lf)", "; "), "#(cr)", "; ")




let
    // Step 1: Define your LOG_STATUS and ToolList tables (replace with your actual table names)
    LOG_STATUS = ... ,  // Your LOG_STATUS table here
    ToolList = ... ,  // Your ToolList table here

    // Step 2: Extract ToolIds from the Error column
    ExtractToolIds = Table.AddColumn(LOG_STATUS, "ExtractedToolIds", each 
        Text.Split(Text.Select([Error], {"0".."9", " "}), " "), type list),

    // Step 3: Replace ToolIds with the corresponding Custom values from ToolList
    ReplaceToolIdsWithCustom = Table.AddColumn(ExtractToolIds, "UpdatedError", each 
        Text.Combine(
            List.Transform([ExtractedToolIds], (toolId) => 
                let
                    // Find the corresponding Custom value from ToolList for the ToolId
                    customValue = try 
                        List.First(Table.SelectRows(ToolList, each Text.From([Tool ID]) = toolId)[Custom]) 
                        otherwise toolId
                in
                    customValue
            ), " "
        )
    )
in
    ReplaceToolIdsWithCustom





