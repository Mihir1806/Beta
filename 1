let
    jobName = [Job Name],
    errorText = [Error],
    toolTable = Table.SelectRows(ToolList, each [Job Name] = jobName),
    numbersText = Text.RegexReplace(errorText, "[^\d]+", " "),
    numbersList = Text.Split(Text.Trim(numbersText), " "),
    matches = List.Transform(numbersList, each Text.From(_)),
    enhancedError = List.Accumulate(
        List.Distinct(matches),
        errorText,
        (state, toolId) =>
            let
                toolRow = try Table.SelectRows(toolTable, each Text.From([Tool ID]) = toolId){0} otherwise null,
                toolName = if toolRow <> null then toolRow[Tool Name] else null
            in
                if toolName <> null then
                    Text.Replace(state, "ToolId " & toolId, "ToolId " & toolId & "(Tool Name : " & toolName & ")")
                else
                    state
    )
in
    enhancedError