SubProduct Table

This table defines the hierarchy levels for each code.
Each code will appear only once, and only in one Niv column from Niv1 to Niv6.

result3 
This contains child–parent code pairs that I want to validate:

Objective:

Split the input into two parts:
	•	result3A: If Type of operation is a valid ancestor (appears in a higher Niv than the SubProductIAS in the same hierarchy chain).
	•	result3B: If Type of operation is not related (not a parent).